<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>YouTube Subscriber Count</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      box-sizing: border-box;
      background-color: white;
      font-family: Arial, sans-serif;
      font-size: 16px; /* base */
    }

    #subscriber-count {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      width: 100%;
      height: 100vh;
      overflow: hidden;
      position: relative;
    }

    #number-wrapper {
      width: 100%;
      display: flex;
      justify-content: center;
    }

    #number {
      display: flex;
      gap: 0.25em;
      transform-origin: left top;
      transition: transform 0.2s ease;
    }

    .digit-container {
      background: white;
      padding: 0.2em;
      border-radius: 0.3em;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .digit, .comma {
      color: black;
      line-height: 1;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .digit {
      font-size: 11.25em; /* 180px */
    }

    .comma {
      font-size: 6.75em; /* 108px */
    }

    .scroll-up {
      animation: scroll-up 0.5s ease-out forwards;
    }

    .scroll-down {
      animation: scroll-down 0.5s ease-out forwards;
    }

    @keyframes scroll-up {
      0% { transform: translateY(100%); }
      100% { transform: translateY(0); }
    }

    @keyframes scroll-down {
      0% { transform: translateY(-100%); }
      100% { transform: translateY(0); }
    }

    @media (max-width: 768px) {
      body { font-size: 14px; }
    }

    @media (max-width: 480px) {
      body { font-size: 12px; }
    }
  </style>
</head>
<body>
  <div id="subscriber-count">
    <div id="number-wrapper">
      <div id="number"></div>
    </div>
  </div>

  <script>
    const channelId = 'UCgSrywNqoqtC4nViMHk6L-g';
    const apiKey = 'AIzaSyA7kJVhZMBaYK7XogAhuVt_mMvF00JAPU8';
    let lastCount = 0;
    let currentDigits = [];
    let actualCount = 0;
    let initialLoadDone = false;

    function fetchSubscriberCount() {
      fetch(`https://www.googleapis.com/youtube/v3/channels?part=statistics&id=${channelId}&key=${apiKey}`)
        .then(r => r.json())
        .then(data => {
          if (data.items?.length) {
            const count = +data.items[0].statistics.subscriberCount;
            actualCount = count;

            if (!initialLoadDone) {
              updateDigits(randomFake(count), true);
              initialLoadDone = true;
            } else if (count !== lastCount) {
              updateDigits(count, false);
            }
            lastCount = count;
          } else {
            document.getElementById('number').innerText = 'Channel not found.';
          }
        })
        .catch(() => {
          document.getElementById('number').innerText = 'Error fetching data.';
        });
    }

    function randomFake(count) {
      const d = count.toString().split('');
      if (count >= 10000) {
        d[d.length - 1] = `${Math.floor(Math.random() * 10)}`;
        d[d.length - 2] = `${Math.floor(Math.random() * 10)}`;
      } else {
        d[d.length - 1] = `${Math.floor(Math.random() * 10)}`;
      }
      return +d.join('');
    }

    function updateDigits(count, animateAll = false) {
      const chars = count.toLocaleString().split('');
      const numEl = document.getElementById('number');
      numEl.innerHTML = '';

      chars.forEach((ch, i) => {
        const container = document.createElement('div');
        container.className = 'digit-container';

        const el = document.createElement('div');
        el.innerText = ch;

        if (ch === ',') {
          el.className = 'comma';
        } else {
          el.className = 'digit';
        }

        if (animateAll || currentDigits[i] !== ch) {
          el.classList.add(ch > (currentDigits[i] || '0') ? 'scroll-up' : 'scroll-down');
        }

        container.appendChild(el);
        numEl.appendChild(container);
      });

      currentDigits = chars;
      scaleToFit();
    }

    function scaleToFit() {
      const wrapper = document.getElementById('number-wrapper');
      const number = document.getElementById('number');

      const wrapperWidth = wrapper.offsetWidth;
      const numberWidth = number.scrollWidth;

      const scale = wrapperWidth / numberWidth;
      number.style.transform = `scale(${Math.min(scale, 1)})`;
    }

    function randomizeOnesPlace() {
      if (!initialLoadDone || !actualCount) return;
      updateDigits(randomFake(actualCount), false);
    }

    fetchSubscriberCount();
    setInterval(fetchSubscriberCount, 20000);
    setInterval(randomizeOnesPlace, 8000);

    window.addEventListener('resize', scaleToFit);
  </script>
</body>
</html>
